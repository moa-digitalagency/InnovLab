<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>

    <title>{% block title %}{{ page_seo.title_tag if page_seo and page_seo.title_tag else seo_settings.meta_title_default }}{% endblock %}</title>
    <meta name="description" content="{% block meta_description %}{{ page_seo.meta_desc if page_seo and page_seo.meta_desc else seo_settings.meta_description_default }}{% endblock %}">
    <meta name="keywords" content="{{ page_seo.keywords if page_seo and page_seo.keywords else seo_settings.meta_keywords_default }}">

    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ request.url }}">
    <meta property="og:title" content="{% block og_title %}{{ self.title() }}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{{ self.meta_description() }}{% endblock %}">
    <meta property="og:image" content="{% block og_image %}{{ request.url_root[:-1] }}{{ seo_settings.og_image_default }}{% endblock %}">
    <meta property="og:site_name" content="{{ seo_settings.og_site_name }}">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="{{ seo_settings.twitter_handle }}">
    <meta name="twitter:title" content="{% block twitter_title %}{{ self.title() }}{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}{{ self.meta_description() }}{% endblock %}">
    <meta name="twitter:image" content="{% block twitter_image %}{{ self.og_image() }}{% endblock %}">

    <link rel="icon" type="image/png" href="{{ url_for('static', filename=site_settings.favicon) if site_settings and site_settings.favicon else url_for('static', filename='img/favicon.ico') }}">
    <link href="https://fonts.googleapis.com" rel="preconnect"/>
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&amp;display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

    <!-- Google Analytics -->
    {% if seo_settings.google_analytics_id %}
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ seo_settings.google_analytics_id }}"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', '{{ seo_settings.google_analytics_id }}');
    </script>
    {% endif %}

    {% block styles %}{% endblock %}

    <!-- Custom Head Code -->
    {% if site_settings and site_settings.custom_head_code %}
    {{ site_settings.custom_head_code | safe }}
    {% endif %}
</head>
<body class="font-sans antialiased bg-[#ffffff] scroll-smooth">

    <!-- ========================================== -->
    <!-- HEADER STICKY                              -->
    <!-- ========================================== -->
    <header class="fixed top-0 left-0 w-full z-50 bg-[#ffffff]/80 backdrop-blur-lg border-b border-slate-100/50 transition-all duration-300" id="main-header">
        <div class="max-w-7xl mx-auto px-4 h-24 flex items-center justify-between">

            <!-- Logo -->
            <a href="{{ url_for('main.index') }}" class="flex items-center gap-3 group">
                {% if site_settings and site_settings.header_logo %}
                <div class="h-16 w-auto flex items-center">
                    <img src="{{ url_for('static', filename=site_settings.header_logo) }}" alt="Shabaka Logo" class="h-full w-auto object-contain group-hover:scale-105 transition-transform duration-300">
                </div>
                {% else %}
                <div class="w-16 h-16 shrink-0 flex items-center justify-center">
                    <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-full h-full drop-shadow-sm group-hover:scale-105 transition-transform duration-300">
                        <path d="M 10 30 L 50 7 L 90 30 L 90 50 L 50 27 L 30 38.5 L 30 60 L 10 48.5 Z" fill="#1d5865"/>
                        <path d="M 90 70 L 50 93 L 10 70 L 10 50 L 50 73 L 70 61.5 L 70 40 L 90 51.5 Z" fill="#1d5865" opacity="0.8"/>
                        <g stroke="#30a192" stroke-width="6" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="30" y1="65" x2="60" y2="35" />
                            <line x1="40" y1="75" x2="70" y2="45" />
                            <line x1="45" y1="50" x2="55" y2="60" />
                            <circle cx="30" cy="65" r="6.5" fill="#30a192" stroke="none"/>
                            <circle cx="60" cy="35" r="6.5" fill="#30a192" stroke="none"/>
                            <circle cx="40" cy="75" r="6.5" fill="#30a192" stroke="none"/>
                            <circle cx="70" cy="45" r="6.5" fill="#30a192" stroke="none"/>
                        </g>
                    </svg>
                </div>
                <div>
                    <h1 class="font-bold text-xl text-[#1d5865] leading-none mb-0.5">Shabaka</h1>
                    <p class="text-[#30a192] text-[10px] font-bold tracking-widest uppercase leading-none">InnovLab</p>
                </div>
                {% endif %}
            </a>

            <!-- Navigation Desktop -->
            <nav class="hidden md:flex items-center gap-8">
                <a href="{{ url_for('main.index') }}" class="text-[#064060]/80 hover:text-[#30a192] text-sm font-medium transition-colors">Accueil</a>
                <a href="{{ url_for('main.about') }}" class="text-[#064060]/80 hover:text-[#30a192] text-sm font-medium transition-colors">L'ADN InnovLab</a>
                <a href="{{ url_for('main.services') }}" class="text-[#064060]/80 hover:text-[#30a192] text-sm font-medium transition-colors">Notre Expertise</a>
                <a href="{{ url_for('main.portfolio') }}" class="text-[#064060]/80 hover:text-[#30a192] text-sm font-medium transition-colors">Nos Forteresses</a>
                <a href="{{ url_for('main.contact_us') }}" class="text-[#064060]/80 hover:text-[#30a192] text-sm font-medium transition-colors">Contact</a>
            </nav>

            <!-- CTA & Menu Mobile Toggle -->
            <div class="flex items-center gap-4">
                <a href="{{ url_for('main.startup') }}" class="inline-flex items-center justify-center px-8 py-3.5 rounded-xl bg-[#076D6D] text-white font-bold text-sm hover:bg-[#055050] hover:-translate-y-1 transition-all duration-300 shadow-lg shadow-[#076D6D]/25 group w-fit hidden sm:inline-flex">
                    Rejoindre l'Aventure
                </a>

                <!-- Mobile Menu IDs Verified -->
                <button id="mobile-menu-btn" class="md:hidden text-[#1d5865] p-2 focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                </button>
            </div>
        </div>

        <!-- Menu Mobile Déroulant -->
        <div id="mobile-menu" class="hidden md:hidden bg-[#ffffff] border-b border-slate-100 absolute w-full left-0 top-24 shadow-xl overflow-hidden transition-all duration-300">
            <div class="flex flex-col px-4 py-6 gap-4">
                <a href="{{ url_for('main.index') }}" class="mobile-link text-[#1d5865] font-bold hover:text-[#30a192] px-4 py-2 bg-slate-50 rounded-lg">Accueil</a>
                <a href="{{ url_for('main.about') }}" class="mobile-link text-[#1d5865] font-bold hover:text-[#30a192] px-4 py-2 bg-slate-50 rounded-lg">L'ADN InnovLab</a>
                <a href="{{ url_for('main.services') }}" class="mobile-link text-[#1d5865] font-bold hover:text-[#30a192] px-4 py-2 bg-slate-50 rounded-lg">Notre Expertise</a>
                <a href="{{ url_for('main.portfolio') }}" class="mobile-link text-[#1d5865] font-bold hover:text-[#30a192] px-4 py-2 bg-slate-50 rounded-lg">Nos Forteresses</a>
                <a href="{{ url_for('main.contact_us') }}" class="mobile-link text-[#1d5865] font-bold hover:text-[#30a192] px-4 py-2 bg-slate-50 rounded-lg">Contact</a>
                <a href="{{ url_for('main.startup') }}" class="mobile-link inline-flex items-center justify-center px-8 py-3.5 rounded-xl bg-[#076D6D] text-white font-bold text-sm hover:bg-[#055050] hover:-translate-y-1 transition-all duration-300 shadow-lg shadow-[#076D6D]/25 group w-fit mt-2">Rejoindre l'Aventure</a>
            </div>
        </div>
    </header>

    <!-- Flash Messages (Toasts) -->
    <div class="fixed top-28 right-4 z-[60] flex flex-col gap-3 w-full max-w-sm pointer-events-none px-4 md:px-0">
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="pointer-events-auto transform transition-all duration-300 ease-in-out translate-x-0 opacity-100 flex items-start gap-3 p-4 rounded-xl shadow-lg border-l-4 {% if category == 'success' %}bg-green-50 border-green-500 text-green-800{% else %}bg-red-50 border-red-500 text-red-800{% endif %}" role="alert">
                <div class="flex-grow text-sm font-medium leading-snug">{{ message }}</div>
                <button onclick="this.parentElement.remove()" class="shrink-0 text-current opacity-50 hover:opacity-100 transition-opacity focus:outline-none p-0.5">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                </button>
              </div>
            {% endfor %}
          {% endif %}
        {% endwith %}
    </div>

    <main class="flex-grow">
        {% block content %}{% endblock %}
    </main>

    <!-- ========================================== -->
    <!-- SECTION 11 : FOOTER                        -->
    <!-- ========================================== -->
    <footer class="bg-[#15344b] pt-20 pb-8 relative overflow-hidden" id="contact">
        <div class="max-w-7xl mx-auto px-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12 lg:gap-8">

            <div class="reveal delay-100">
                <div class="flex items-center gap-3 mb-6">
                    <div class="w-16 h-16 shrink-0 flex items-center justify-center">
                        {% if site_settings and site_settings.footer_logo %}
                        <img src="{{ url_for('static', filename=site_settings.footer_logo) }}" alt="Shabaka Logo" class="w-full h-full object-contain drop-shadow-md">
                        {% else %}
                        <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-full h-full drop-shadow-md">
                            <path d="M 10 30 L 50 7 L 90 30 L 90 50 L 50 27 L 30 38.5 L 30 60 L 10 48.5 Z" fill="#ffffff" opacity="0.95"/>
                            <path d="M 90 70 L 50 93 L 10 70 L 10 50 L 50 73 L 70 61.5 L 70 40 L 90 51.5 Z" fill="#ffffff" opacity="0.6"/>
                            <g stroke="#30a192" stroke-width="6" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="30" y1="65" x2="60" y2="35" />
                                <line x1="40" y1="75" x2="70" y2="45" />
                                <line x1="45" y1="50" x2="55" y2="60" />
                                <circle cx="30" cy="65" r="6.5" fill="#30a192" stroke="none"/>
                                <circle cx="60" cy="35" r="6.5" fill="#30a192" stroke="none"/>
                                <circle cx="40" cy="75" r="6.5" fill="#30a192" stroke="none"/>
                                <circle cx="70" cy="45" r="6.5" fill="#30a192" stroke="none"/>
                            </g>
                        </svg>
                        {% endif %}
                    </div>
                    {% if not (site_settings and site_settings.footer_logo) %}
                    <div>
                        <h3 class="font-bold text-2xl text-[#ffffff] leading-none mb-1">Shabaka</h3>
                        <p class="text-[#30a192] text-sm font-bold tracking-widest uppercase leading-none">InnovLab</p>
                    </div>
                    {% endif %}
                </div>
                <p class="text-blue-100/80 text-sm leading-relaxed mb-6 pr-4">
                    Le point de convergence de l'innovation, du capital et de l'industrie pour une Afrique souveraine.
                </p>


                <form action="{{ url_for('forms.contact_submit') }}" method="POST" class="flex gap-2">
                    <input type="email" name="email" placeholder="Votre email" class="bg-[#1d5865]/30 border border-[#1d5865]/50 rounded-lg px-4 py-2.5 text-sm w-full focus:outline-none focus:border-[#30a192] text-[#ffffff] placeholder-[#8f8e8e] transition-colors" required>
                    <button type="submit" class="bg-[#30a192] hover:bg-[#258073] text-[#ffffff] rounded-lg px-4 py-2.5 transition-colors flex items-center justify-center shrink-0">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                    </button>
                </form>
            </div>

            <div class="reveal delay-200">
                <h4 class="font-bold text-lg text-[#ffffff] mb-6 pb-2 border-b border-[#30a192]/50 inline-block">Contact Direct</h4>
                <ul class="space-y-4">
                    <li class="flex items-start gap-3">
                        <svg class="w-5 h-5 text-[#30a192] shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                        <span class="text-blue-100/80 text-sm leading-relaxed">{{ site_settings.address if site_settings else "Centre d'affaires Gueliz, Bd My Rachid, Étage 1, Bureau 8, 40000 Marrakech" }}</span>
                    </li>
                    <li class="flex items-center gap-3">
                        <svg class="w-5 h-5 text-[#30a192] shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
                        <span class="text-blue-100/80 text-sm">{{ site_settings.phone if site_settings else "+212 699 14 00 01" }}</span>
                    </li>
                    <li class="flex items-center gap-3">
                        <svg class="w-5 h-5 text-[#30a192] shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
                        <span class="text-blue-100/80 text-sm">{{ site_settings.contact_email if site_settings else 'nticshabaka@gmail.com' }}</span>
                    </li>
                </ul>
            </div>

            <div class="reveal delay-300">
                <h4 class="font-bold text-lg text-[#ffffff] mb-6 pb-2 border-b border-[#30a192]/50 inline-block">Navigation</h4>
                <ul class="space-y-3">
                    <li><a href="{{ url_for('main.index') }}" class="text-blue-100/80 text-sm hover:text-[#30a192] transition-colors">Accueil</a></li>
                    <li><a href="{{ url_for('main.about') }}" class="text-blue-100/80 text-sm hover:text-[#30a192] transition-colors">L'ADN InnovLab</a></li>
                    <li><a href="{{ url_for('main.services') }}" class="text-blue-100/80 text-sm hover:text-[#30a192] transition-colors">Notre Expertise</a></li>
                    <li><a href="{{ url_for('main.portfolio') }}" class="text-blue-100/80 text-sm hover:text-[#30a192] transition-colors">Nos Forteresses</a></li>
                    <li><a href="{{ url_for('main.contact_us') }}" class="text-blue-100/80 text-sm hover:text-[#30a192] transition-colors">Contact</a></li>
                </ul>
            </div>

            <div class="reveal delay-400">
                <h4 class="font-bold text-lg text-[#ffffff] mb-6 pb-2 border-b border-[#30a192]/50 inline-block">Mentions Légales</h4>
                <p class="text-blue-100/80 text-sm leading-relaxed mb-6">
                    SHABAKA InnovLab SARL, Filiale de SHABAKA Invest Group est une entreprise de droit marocain domiciliée à Marrakech
                </p>
                <a href="https://www.shabakainvestgroup.com" target="_blank" class="inline-flex items-center gap-2 bg-[#ffffff]/5 border border-[#ffffff]/10 hover:bg-[#ffffff]/10 transition-colors text-blue-100/80 hover:text-[#ffffff] text-sm py-2 px-4 rounded-lg w-fit">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>
                    Site Corporate
                </a>
            </div>

        </div>

        <div class="max-w-7xl mx-auto px-4 mt-16 reveal delay-500">
            <div class="border-t border-[#ffffff]/10 pt-8 flex flex-col md:flex-row justify-between items-center gap-4">
                <p class="text-blue-100/60 text-xs text-center md:text-left">
                    © 2024 Shabaka InnovLab. Tous droits réservés.
                </p>
                <div class="flex flex-wrap justify-center gap-6">
                    <a href="{{ url_for('main.privacy_policy') }}" class="text-blue-100/80 hover:text-[#ffffff] text-xs transition-colors">Politique de Confidentialité</a>
                    <a href="{{ url_for('main.terms_conditions') }}" class="text-blue-100/80 hover:text-[#ffffff] text-xs transition-colors">Conditions Générales</a>
                </div>
            </div>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/script.js') }}" defer></script>
</body>
</html>
